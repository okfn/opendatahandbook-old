Open Data Manual
================

Introduction
------------

Welcome to the source of the `Open Data Manual`_. The manual is a project of
the `Open Knowledge Foundation`_.  If you are reading this it is likely you are
looking to contribute in some way, whether that's translation, feedback,
editing or adding more content. If you just want to read the manual, then
please head over to the http://opendatamanual.org/.

.. _Open Data Manual: http://opendatamanual.org/
.. _Open Knowledge Foundation: http://okfn.org/
.. _Sphinx: http://sphinx.pocoo.org/

Contributing
------------

We have several ways you can help. The project is split into a few 
roles. Our **authors** write content, **editors** merge those 
submissions into the manual, **designers** help beautify it and 
**translators** bring the manual to all countries of the world.

`Our wiki`_ is a great place to get started. It contains a large
number of tasks for people with `half an hour`_ as well as `larger
tasks`_. 

.. _our wiki: http://wiki.okfn.org/Open_Data_Manual#Contributing
.. _half an hour: http://wiki.okfn.org/Open_Data_Manual#Micro-tasks
.. _larger tasks: http://wiki.okfn.org/Open_Data_Manual#Sections_that_need_authors

Resources
---------

:Home Page:     http://wiki.okfn.org/Open_Data_Manual
:Mailing List:  http://lists.okfn.org/mailman/listinfo/open-data-manual
:Source:        https://github.org/okfn/opendatamanual
:Translations:  https://www.transifex.net/projects/p/opendatamanual/

About our tools
---------------

The manual is written the `ReStructured Text`_ format. `ReStructured Text` allows
us to write files in plain text files, which can be nicely rendered as a website
or a PDF using `Sphinx`_.

.. _restructured text: http://docutils.sourceforge.net/docs/user/rst/quickref.html

Project Layout
--------------

Outline::

  opendatamanual/
    source/
    bin/
    build/
    translation/

Details:

| ``opendatamanual`` is the base directory.
|
|    ``source`` is where we keep the plain text source files.
|
|    ``bin`` is short for binaries, or executable commands. This folder keeps holds handy scripts.
|
|    ``build`` is where rendered, or "built", HTML files live.  
|
|    ``translation`` is where our i18n files are kept

Rendering the manual
--------------------

1. Move into the base directory of the project

::

    cd opendatamanual

2. Get the themes

::

   git submodule init 
   git submodule update 

3. Install `Sphinx`, with a minimum version of 0.6. Instructions for Debian and Ubuntu:

::

    apt-get install python-sphinx

4. Render the HTML, using ``make``.  

::

    make html
   
Building for Translation (i18n)
-------------------------------

Generating pot files
~~~~~~~~~~~~~~~~~~~~

1. Install Sphinx HEAD from the `official source repo 
   <https://bitbucket.org/birkenfeld/sphinx/>`_.

2. Extract translateable sentences

::

    make gettext

3. Add or update the ``translated/all.pot`` file as a resource on
   https://www.transifex.net/projects/p/opendatamanual/.

Adding a new language
~~~~~~~~~~~~~~~~~~~~~

We use transifex for this.

1. Go to https://www.transifex.net/projects/p/opendatamanual/
2. Add translation for specified language (and a team)

Building a translation of the manual
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. Download the translated all.pot file and copy it to (where lang is 2-digit iso-code)::
   
    translation/{lang}/LC_MESSAGES/all.po

2. Build the mo file. In the directory of the all.po file do::

    msgfmt all.po -o all.mo

3. Symlink from all.mo (sphinx expects us to have kept with original file names
   generated by gettext rather than concatenating)::

    make linkpot lang={lang}

4. Build the translation::

    make html lang={lang}

